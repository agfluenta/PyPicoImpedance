# Impedance Analysis with PicoScope

This project contains a small Python utility that turns a PicoScope 3000A into a
logarithmic impedance analyser. The analyser excites a device under test (DUT)
with a 2 Vpp sine wave generated by the scope, measures the resulting voltage
waveforms across both a known reference resistor and the DUT, and derives the
complex impedance for each frequency point. By default the script sweeps from
30 kHz to 60 kHz with 2000 points per decade (750 points across the configured
range).

## Requirements

- PicoScope hardware that is compatible with the `ps3000a` driver
- PicoScope drivers installed on the host machine
- PicoSDK for Python installed (see `requirements.txt` for Python dependencies)

## Connections

The script assumes the following wiring:

- The PicoScope built-in signal generator drives the series combination of a
  known reference resistor and the DUT.
- Channel A measures the voltage across the reference resistor.
- Channel B measures the voltage across the DUT.

The reference resistor value is passed to the script (default: 1 kΩ) so that the
current through the DUT can be derived from the measured voltage.

## Usage

Install the Python dependencies and ensure the PicoSDK shared libraries are in
your system path. Then run the analyser:

```bash
python main.py --plot --csv results.csv
```

Useful command-line options include:

- `--reference` — value of the reference resistor in ohms.
- `--samples` — number of samples acquired per waveform (default 4096).
- `--cycles` — number of stimulus cycles captured in each acquisition window.
- `--settle` — dwell time after changing the signal generator frequency.
- `--vpp` — peak-to-peak voltage for the stimulus (default 2 V).

The `--plot` flag displays a bode plot of the measured impedance, and the
`--csv` flag writes the sweep to a CSV file for further processing.
